# OpenClaw æ ¸å¿ƒè®¾è®¡æ€»ç»“

> **ç›®æ ‡**ï¼šåˆ†æ OpenClaw çš„æ ¸å¿ƒæ¶æ„è®¾è®¡ï¼Œä¸ºåç»­å¼€å‘ç®€æ˜“ç‰ˆæœ¬ AI åŠ©ç†æä¾›å‚è€ƒã€‚

---

## ä¸€ã€é¡¹ç›®å®šä½ä¸æ¦‚è¿°

**OpenClaw** æ˜¯ä¸€ä¸ª**ä¸ªäºº AI åŠ©ç†å¹³å°**ï¼Œæ ¸å¿ƒç†å¿µæ˜¯ï¼š
- **æœ¬åœ°ä¼˜å…ˆï¼ˆLocal-firstï¼‰**ï¼šè¿è¡Œåœ¨ä½ è‡ªå·±çš„è®¾å¤‡ä¸Š
- **å¤šé€šé“ï¼ˆMulti-channelï¼‰**ï¼šè¿æ¥ WhatsAppã€Telegramã€Slackã€Discordã€Signalã€iMessageã€WebChat ç­‰æ¶ˆæ¯æ¸ é“
- **å•ç”¨æˆ·ï¼ˆSingle-userï¼‰**ï¼šé¢å‘ä¸ªäººä½¿ç”¨çš„ç§æœ‰åŠ©ç†
- **å…¨å¹³å°**ï¼šæ”¯æŒ macOS èœå•æ åº”ç”¨ã€iOS/Android èŠ‚ç‚¹ã€CLIã€Web UI

---

## äºŒã€æ•´ä½“æ¶æ„

```
æ¶ˆæ¯æ¸ é“ï¼ˆWhatsApp / Telegram / Slack / Discord / Signal / WebChat / ...ï¼‰
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Gatewayï¼ˆç½‘å…³ï¼‰              â”‚
â”‚         WebSocket æ§åˆ¶é¢æ¿             â”‚
â”‚       ws://127.0.0.1:18789            â”‚
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Channel Managerï¼ˆé€šé“ç®¡ç†å™¨ï¼‰    â”‚  â”‚
â”‚  â”‚  Session Managerï¼ˆä¼šè¯ç®¡ç†å™¨ï¼‰    â”‚  â”‚
â”‚  â”‚  Agent Runtimeï¼ˆAI ä»£ç†è¿è¡Œæ—¶ï¼‰   â”‚  â”‚
â”‚  â”‚  Tool Systemï¼ˆå·¥å…·ç³»ç»Ÿï¼‰         â”‚  â”‚
â”‚  â”‚  Config Systemï¼ˆé…ç½®ç³»ç»Ÿï¼‰       â”‚  â”‚
â”‚  â”‚  Plugin Systemï¼ˆæ’ä»¶ç³»ç»Ÿï¼‰       â”‚  â”‚
â”‚  â”‚  Cron Systemï¼ˆå®šæ—¶ä»»åŠ¡ç³»ç»Ÿï¼‰     â”‚  â”‚
â”‚  â”‚  Auth Systemï¼ˆè®¤è¯ç³»ç»Ÿï¼‰         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”œâ”€ Pi Agentï¼ˆAI ä»£ç† RPC æ¨¡å¼ï¼‰
               â”œâ”€ CLIï¼ˆopenclaw å‘½ä»¤è¡Œï¼‰
               â”œâ”€ WebChat UI
               â”œâ”€ macOS Menu Bar App
               â””â”€ iOS / Android Nodes
```

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **Gateway æ˜¯å”¯ä¸€çš„æ§åˆ¶é¢æ¿**ï¼šæ‰€æœ‰æ¶ˆæ¯è·¯ç”±ã€ä¼šè¯ç®¡ç†ã€å·¥å…·è°ƒç”¨éƒ½é€šè¿‡ Gateway è¿›è¡Œ
2. **WebSocket é€šä¿¡**ï¼šGateway ä¸æ‰€æœ‰å®¢æˆ·ç«¯ï¼ˆCLIã€Appã€WebChatï¼‰é€šè¿‡ WS è¿æ¥
3. **Channel æŠ½è±¡å±‚**ï¼šæ¯ä¸ªæ¶ˆæ¯æ¸ é“ï¼ˆWhatsApp/Telegram ç­‰ï¼‰éƒ½æœ‰ç»Ÿä¸€çš„ Channel æ¥å£
4. **ä¼šè¯éš”ç¦»**ï¼šæ¯ä¸ªèŠå¤©ï¼ˆDMã€ç¾¤ç»„ï¼‰æœ‰ç‹¬ç«‹çš„ Sessionï¼Œäº’ä¸å½±å“

---

## ä¸‰ã€æ ¸å¿ƒæ¨¡å—åˆ†æ

### 3.1 ç›®å½•ç»“æ„ï¼ˆ`src/`ï¼‰

| ç›®å½• | èŒè´£ | å¤æ‚åº¦ |
|------|------|--------|
| `src/gateway/` | **æ ¸å¿ƒä¸­æ¢**ï¼šWS æœåŠ¡å™¨ã€HTTP æœåŠ¡ã€ä¼šè¯ç®¡ç†ã€è®¤è¯ | â˜…â˜…â˜…â˜…â˜… |
| `src/agents/` | **AI ä»£ç†**ï¼šæ¨¡å‹è°ƒç”¨ã€å·¥å…·å®šä¹‰ã€ç³»ç»Ÿ Promptã€ä¸Šä¸‹æ–‡ç®¡ç† | â˜…â˜…â˜…â˜…â˜… |
| `src/auto-reply/` | **è‡ªåŠ¨å›å¤**ï¼šæ¶ˆæ¯å¤„ç†ã€æ¨¡æ¿ã€åˆ†å—ã€å‘½ä»¤è§£æ | â˜…â˜…â˜…â˜… |
| `src/channels/` | **é€šé“æŠ½è±¡å±‚**ï¼šChannel æ³¨å†Œã€é…ç½®ã€session æ˜ å°„ | â˜…â˜…â˜… |
| `src/config/` | **é…ç½®ç³»ç»Ÿ**ï¼šJSON5 é…ç½®ã€Schema éªŒè¯ã€ç¯å¢ƒå˜é‡ | â˜…â˜…â˜…â˜… |
| `src/cli/` | **å‘½ä»¤è¡Œ**ï¼šCommander.js ç¨‹åºã€å„æ‰‹åŠ¨å‘½ä»¤ | â˜…â˜…â˜… |
| `src/commands/` | **å­å‘½ä»¤**ï¼šgatewayã€agentã€sendã€onboard ç­‰ | â˜…â˜…â˜… |
| `src/plugins/` | **æ’ä»¶ç³»ç»Ÿ**ï¼šæ’ä»¶åŠ è½½ã€æ³¨å†Œã€è¿è¡Œ | â˜…â˜…â˜… |
| `src/infra/` | **åŸºç¡€è®¾æ–½**ï¼šæ—¥å¿—ã€ç«¯å£ã€ç¯å¢ƒã€äºŒè¿›åˆ¶ç®¡ç† | â˜…â˜… |
| `src/media/` | **åª’ä½“å¤„ç†**ï¼šå›¾ç‰‡/éŸ³é¢‘/è§†é¢‘è½¬ç ã€å¤§å°é™åˆ¶ | â˜…â˜… |
| `src/browser/` | **æµè§ˆå™¨æ§åˆ¶**ï¼šPlaywright CDP æ§åˆ¶ Chrome | â˜…â˜…â˜… |
| `src/memory/` | **è®°å¿†ç³»ç»Ÿ**ï¼šSQLite å‘é‡å­˜å‚¨ | â˜…â˜… |
| `src/hooks/` | **é’©å­ç³»ç»Ÿ**ï¼šäº‹ä»¶é’©å­ | â˜…â˜… |
| `src/cron/` | **å®šæ—¶ä»»åŠ¡** | â˜…â˜… |
| `src/routing/` | **æ¶ˆæ¯è·¯ç”±**ï¼šå¤š agent è·¯ç”± | â˜…â˜… |
| `src/security/` | **å®‰å…¨æ€§**ï¼šæ²™ç®±ã€æƒé™ | â˜…â˜… |

### 3.2 å„æ¶ˆæ¯æ¸ é“ç›®å½•

| ç›®å½• | ä¾èµ–åº“ |
|------|--------|
| `src/telegram/` | grammY |
| `src/discord/` | discord.js / @buape/carbon |
| `src/slack/` | @slack/bolt |
| `src/signal/` | signal-cli |
| `src/imessage/` | åŸç”Ÿ macOS |
| `src/whatsapp/` | @whiskeysockets/baileys |
| `src/web/` | å†…å»º WebSocket |

### 3.3 æ‰©å±•é€šé“ï¼ˆ`extensions/`ï¼‰

é€šè¿‡æ’ä»¶ç³»ç»Ÿæ‰©å±•ï¼Œå…± 38 ä¸ªæ‰©å±•ï¼ŒåŒ…æ‹¬ï¼š
- `msteams`ï¼ˆMicrosoft Teamsï¼‰
- `matrix`ï¼ˆMatrix åè®®ï¼‰
- `zalo` / `zalouser`
- `bluebubbles`ï¼ˆiMessage æ¨èï¼‰
- `googlechat`
- `feishu`ï¼ˆé£ä¹¦ï¼‰
- `twitch` / `nostr` / `irc` / `line`
- `voice-call`ï¼ˆè¯­éŸ³é€šè¯ï¼‰
- `memory-lancedb`ï¼ˆLanceDB è®°å¿†ï¼‰

---

## å››ã€æ ¸å¿ƒæ•°æ®æµ

### 4.1 æ¶ˆæ¯å¤„ç†æµç¨‹

```
1. ç”¨æˆ·å‘é€æ¶ˆæ¯ â†’ Channel æ¥æ”¶
2. Channel â†’ Gateway çš„ inbound handler
3. Inbound â†’ è§£æå‘½ä»¤ï¼ˆ/status, /new, /think ç­‰ï¼‰
4. å‘½ä»¤ â†’ ç›´æ¥å¤„ç†å¹¶è¿”å›
5. æ™®é€šæ¶ˆæ¯ â†’ Session æŸ¥æ‰¾/åˆ›å»º
6. Session â†’ Agent Runtimeï¼ˆPi Agentï¼‰
7. Agent â†’ è°ƒç”¨ AI æ¨¡å‹ï¼ˆAnthropic/OpenAI/Google ç­‰ï¼‰
8. AI å›å¤ â†’ Stream åˆ†å—
9. åˆ†å— â†’ é€šè¿‡ Channel å‘é€å›ç”¨æˆ·
```

### 4.2 Agent Loopï¼ˆAI ä»£ç†å¾ªç¯ï¼‰

```
æ”¶åˆ°ç”¨æˆ·æ¶ˆæ¯
    â”‚
    â–¼
æ„å»º System Promptï¼ˆèº«ä»½ + å·¥å…·æè¿° + Workspace å†…å®¹ + Skillsï¼‰
    â”‚
    â–¼
åŠ è½½ Session Historyï¼ˆå¯¹è¯å†å²ï¼‰
    â”‚
    â–¼
è°ƒç”¨ AI Model APIï¼ˆæµå¼ï¼‰
    â”‚
    â”œâ”€ æ–‡æœ¬å›å¤ â†’ åˆ†å— â†’ å‘é€ç»™ç”¨æˆ·
    â”‚
    â””â”€ Tool Callï¼ˆå·¥å…·è°ƒç”¨ï¼‰
        â”‚
        â”œâ”€ bashï¼ˆæ‰§è¡Œå‘½ä»¤ï¼‰
        â”œâ”€ readï¼ˆè¯»æ–‡ä»¶ï¼‰
        â”œâ”€ writeï¼ˆå†™æ–‡ä»¶ï¼‰
        â”œâ”€ editï¼ˆç¼–è¾‘æ–‡ä»¶ï¼‰
        â”œâ”€ browserï¼ˆæµè§ˆå™¨æ“ä½œï¼‰
        â”œâ”€ canvasï¼ˆå¯è§†åŒ–ç”»å¸ƒï¼‰
        â”œâ”€ cronï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰
        â”œâ”€ sessions_*ï¼ˆå¤š session åè°ƒï¼‰
        â””â”€ è‡ªå®šä¹‰å·¥å…·ï¼ˆplugin/skill å®šä¹‰ï¼‰
        â”‚
        â–¼
    å·¥å…·æ‰§è¡Œç»“æœ â†’ è¿½åŠ åˆ°ä¸Šä¸‹æ–‡ â†’ å†æ¬¡è°ƒç”¨ AI â†’ å¾ªç¯...
```

### 4.3 å…³é”®ä»£ç å…¥å£

| æ–‡ä»¶ | ä½œç”¨ |
|------|------|
| `src/entry.ts` | CLI å…¥å£ç‚¹ï¼Œå¤„ç† Node.js å¯åŠ¨å‚æ•° |
| `src/index.ts` | æ¨¡å—å…¥å£ï¼ŒåŠ è½½ .envï¼Œæ„å»º CLI ç¨‹åº |
| `src/cli/program.ts` | Commander.js å‘½ä»¤å®šä¹‰ |
| `src/gateway/server.impl.ts` | **æœ€æ ¸å¿ƒ**ï¼šGateway æœåŠ¡å™¨å®ç°ï¼ˆ~785 è¡Œï¼‰ |
| `src/agents/pi-embedded-runner.ts` | AI Agent åµŒå…¥å¼è¿è¡Œå™¨ |
| `src/agents/system-prompt.ts` | ç³»ç»Ÿ Prompt æ„å»º |
| `src/auto-reply/reply.ts` | è‡ªåŠ¨å›å¤å…¥å£ |
| `src/auto-reply/chunk.ts` | æ¶ˆæ¯åˆ†å—ï¼ˆé€‚é…ä¸åŒæ¸ é“çš„å­—æ•°é™åˆ¶ï¼‰ |
| `src/channels/dock.ts` | Channel æ³¨å†Œ/ç®¡ç†ä¸­å¿ƒ |

---

## äº”ã€æ ¸å¿ƒç³»ç»Ÿè¯¦è§£

### 5.1 Gateway ç³»ç»Ÿ

Gateway æ˜¯æ•´ä¸ª OpenClaw çš„**æ ¸å¿ƒä¸­æ¢**ï¼ŒèŒè´£ï¼š

1. **WebSocket æœåŠ¡å™¨**ï¼ˆç«¯å£ 18789ï¼‰
   - æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼ˆCLIã€macOS Appã€iOS/Androidã€WebChatï¼‰
   - åŸºäºæ–¹æ³•çš„ RPC é€šä¿¡åè®®
   - æ”¯æŒè®¤è¯ï¼ˆå¯†ç æ¨¡å¼ / Tailscale èº«ä»½å¤´ï¼‰

2. **HTTP æœåŠ¡å™¨**
   - Control UIï¼ˆWeb ç®¡ç†ç•Œé¢ï¼‰
   - WebChat ç•Œé¢
   - OpenAI å…¼å®¹ APIï¼ˆChat Completions + Open Responsesï¼‰
   - Webhook æ¥æ”¶ç«¯

3. **Channel ç®¡ç†**
   - å¯åŠ¨/åœæ­¢å„æ¶ˆæ¯æ¸ é“è¿æ¥
   - å¥åº·ç›‘æ§
   - çƒ­é‡è½½

4. **ä¼šè¯ç®¡ç†**
   - ä¼šè¯åˆ›å»º/é”€æ¯
   - ä¼šè¯çŠ¶æ€æŒä¹…åŒ–ï¼ˆJSONL æ–‡ä»¶ï¼‰
   - ä¼šè¯éš”ç¦»ï¼ˆmain session vs group sessionsï¼‰

5. **Node æ³¨å†Œ**
   - macOS/iOS/Android è®¾å¤‡æ³¨å†Œ
   - è¿œç¨‹å·¥å…·è°ƒç”¨è·¯ç”±

### 5.2 Agent ç³»ç»Ÿ

Agent ç³»ç»Ÿä½äº `src/agents/`ï¼Œæ˜¯ AI äº¤äº’çš„æ ¸å¿ƒï¼š

#### æ¨¡å‹æ”¯æŒ
- **Provider åˆ—è¡¨**ï¼šAnthropicã€OpenAIã€Google Geminiã€Bedrockã€Ollamaã€Togetherã€Veniceã€BytePlus/VolcEngineã€Moonshotã€Minimaxã€HuggingFaceã€z.ai ä»¥åŠæ›´å¤š
- **æ¨¡å‹æ•…éšœè½¬ç§»**ï¼ˆModel Failoverï¼‰ï¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æ¨¡å‹/è®¤è¯
- **Auth Profile è½®è½¬**ï¼šæ”¯æŒå¤šä¸ª API Key è½®æ¢

#### æ ¸å¿ƒ Agent æ–‡ä»¶
| æ–‡ä»¶ | èŒè´£ |
|------|------|
| `system-prompt.ts` | æ„å»ºç³»ç»Ÿ Promptï¼ˆ~800 è¡Œï¼ŒåŒ…å«èº«ä»½ã€æ—¥æœŸæ—¶é—´ã€å·¥å…·ã€æŠ€èƒ½ç­‰ï¼‰ |
| `pi-embedded-runner/` | åµŒå…¥å¼ Agent è¿è¡Œå™¨ï¼ˆä½¿ç”¨ @mariozechner/pi-agent-core åº“ï¼‰ |
| `pi-embedded-subscribe.ts` | è®¢é˜… AI æµå¼è¾“å‡ºã€å¤„ç† Tool Call |
| `model-selection.ts` | æ¨¡å‹é€‰æ‹©é€»è¾‘ |
| `model-fallback.ts` | æ¨¡å‹æ•…éšœè½¬ç§» |
| `bash-tools.exec.ts` | Bash å‘½ä»¤æ‰§è¡Œå·¥å…·å®ç° |
| `pi-tools.ts` | æ‰€æœ‰å·¥å…·å®šä¹‰çš„èšåˆ |
| `compaction.ts` | ä¸Šä¸‹æ–‡å‹ç¼©ï¼ˆå½“å†å²å¤ªé•¿æ—¶è‡ªåŠ¨æ‘˜è¦ï¼‰ |
| `skills.ts` | Skill åŠ è½½å’Œ Prompt æ³¨å…¥ |
| `workspace.ts` | Workspace æ–‡ä»¶åŠ è½½ï¼ˆAGENTS.md, SOUL.md, TOOLS.mdï¼‰ |

#### å·¥å…·ç³»ç»Ÿ
å·¥å…·åœ¨ `src/agents/tools/` ä¸‹å®šä¹‰ï¼Œä¸»è¦ç±»åˆ«ï¼š
- **æ–‡ä»¶æ“ä½œ**ï¼šreadã€writeã€edit
- **å‘½ä»¤æ‰§è¡Œ**ï¼šbashï¼ˆæ”¯æŒ PTYã€Docker sandboxï¼‰
- **æµè§ˆå™¨**ï¼šæ‰“å¼€ URLã€æˆªå›¾ã€äº¤äº’
- **Canvas**ï¼šA2UI å¯è§†åŒ–ç”»å¸ƒ
- **èŠ‚ç‚¹æ“ä½œ**ï¼šcameraã€screen recordã€location
- **ä¼šè¯ç®¡ç†**ï¼šsessions_listã€sessions_sendã€sessions_spawn
- **å®šæ—¶ä»»åŠ¡**ï¼šcron

### 5.3 Session ç³»ç»Ÿ

Session æ˜¯å¯¹è¯çš„æ ¸å¿ƒæŠ½è±¡ï¼š

```typescript
// Session ç±»å‹
- "main"ï¼šä¸»ä¼šè¯ï¼ˆDM 1:1 å¯¹è¯ï¼‰
- group sessionsï¼šç¾¤ç»„ä¼šè¯
- subagent sessionsï¼šå­ Agent ä¼šè¯
```

**å­˜å‚¨ç»“æ„**ï¼š
```
~/.openclaw/
â”œâ”€â”€ openclaw.json          # å…¨å±€é…ç½®
â”œâ”€â”€ credentials/           # æ¸ é“å‡­è¯
â”œâ”€â”€ sessions/              # Session æ•°æ®ï¼ˆJSONLï¼‰
â”œâ”€â”€ workspace/             # Agent å·¥ä½œç©ºé—´
â”‚   â”œâ”€â”€ AGENTS.md          # Agent äººæ ¼æŒ‡ä»¤
â”‚   â”œâ”€â”€ SOUL.md            # AI çµé­‚/æ€§æ ¼
â”‚   â”œâ”€â”€ TOOLS.md           # å·¥å…·è¯´æ˜
â”‚   â””â”€â”€ skills/            # æŠ€èƒ½ç›®å½•
â”‚       â””â”€â”€ <skill>/SKILL.md
â””â”€â”€ agents/                # Agent æ•°æ®
    â””â”€â”€ <agentId>/
        â””â”€â”€ sessions/*.jsonl
```

### 5.4 é…ç½®ç³»ç»Ÿ

é…ç½®ä½äº `~/.openclaw/openclaw.json`ï¼ˆJSON5 æ ¼å¼ï¼‰ï¼Œå…³é”®é…ç½®å—ï¼š

```json5
{
  // AI æ¨¡å‹é…ç½®
  agent: {
    model: "anthropic/claude-opus-4-6",
    thinkingLevel: "medium",
  },
  // Agent é»˜è®¤å€¼
  agents: {
    defaults: {
      workspace: "~/.openclaw/workspace",
      sandbox: { mode: "non-main" },
    },
  },
  // å„æ¶ˆæ¯æ¸ é“é…ç½®
  channels: {
    whatsapp: { allowFrom: [...] },
    telegram: { botToken: "..." },
    discord: { token: "..." },
    slack: { botToken: "...", appToken: "..." },
  },
  // Gateway é…ç½®
  gateway: {
    port: 18789,
    bind: "loopback",
    auth: { mode: "password", password: "..." },
  },
  // å·¥å…·é…ç½®
  tools: { allow: [...], deny: [...] },
  // æµè§ˆå™¨æ§åˆ¶
  browser: { enabled: true },
}
```

é…ç½®ç³»ç»Ÿç‰¹ç‚¹ï¼š
- **TypeBox Schema** ä¸¥æ ¼ç±»å‹æ ¡éªŒ
- **Zod Schema** è¿è¡Œæ—¶éªŒè¯
- **ç¯å¢ƒå˜é‡æ›¿æ¢**ï¼šæ”¯æŒ `${ENV_VAR}` è¯­æ³•
- **é…ç½®ç»§æ‰¿/åˆå¹¶**ï¼š`includes` å­—æ®µæ”¯æŒé…ç½®æ–‡ä»¶å¼•ç”¨
- **çƒ­é‡è½½**ï¼šGateway è¿è¡Œæ—¶å¯ä»¥é‡æ–°åŠ è½½é…ç½®

### 5.5 Plugin ç³»ç»Ÿ

```
extensions/
â”œâ”€â”€ bluebubbles/      # iMessage é€šè¿‡ BlueBubbles
â”œâ”€â”€ msteams/          # Microsoft Teams
â”œâ”€â”€ matrix/           # Matrix åè®®
â”œâ”€â”€ googlechat/       # Google Chat
â”œâ”€â”€ feishu/           # é£ä¹¦
â”œâ”€â”€ voice-call/       # è¯­éŸ³é€šè¯ï¼ˆElevenLabs TTSï¼‰
â”œâ”€â”€ memory-lancedb/   # LanceDB å‘é‡è®°å¿†
â”œâ”€â”€ open-prose/       # å¼€æ”¾æ•£æ–‡ï¼ˆé•¿æ–‡æœ¬å¤„ç†ï¼‰
â””â”€â”€ ... (38 ä¸ªæ‰©å±•åŒ…)
```

æ’ä»¶é€šè¿‡ `openclaw/plugin-sdk` å¼€å‘ï¼Œè¿è¡Œäºç‹¬ç«‹ `package.json` çš„ workspace åŒ…ã€‚

### 5.6 é€šä¿¡åè®®

Gateway WS åè®®åŸºäº **JSON-RPC é£æ ¼**çš„æ–¹æ³•è°ƒç”¨ï¼š

```typescript
// å®¢æˆ·ç«¯ â†’ Gateway
{ method: "chat.send", params: { sessionKey, message, ... } }
{ method: "sessions.list", params: {} }
{ method: "sessions.patch", params: { sessionKey, ... } }
{ method: "config.get", params: {} }
{ method: "node.invoke", params: { nodeId, action, ... } }

// Gateway â†’ å®¢æˆ·ç«¯ï¼ˆäº‹ä»¶å¹¿æ’­ï¼‰
{ event: "chat.message", data: { sessionKey, text, ... } }
{ event: "chat.typing", data: { sessionKey, ... } }
{ event: "agent.tool_call", data: { ... } }
{ event: "update.available", data: { version, ... } }
```

---

## å…­ã€æŠ€æœ¯æ ˆ

| å±‚é¢ | æŠ€æœ¯ |
|------|------|
| è¯­è¨€ | TypeScript (ESM) |
| è¿è¡Œæ—¶ | Node.js 22+ï¼ˆä¹Ÿæ”¯æŒ Bunï¼‰ |
| åŒ…ç®¡ç† | pnpm |
| æ„å»º | tsdownï¼ˆåŸºäº esbuildï¼‰ |
| AI SDK | @mariozechner/pi-agent-coreï¼ˆåµŒå…¥å¼ AI ä»£ç†æ ¸å¿ƒåº“ï¼‰ |
| HTTP | Express 5 |
| WebSocket | ws |
| CLI | Commander.js |
| ç±»å‹æ ¡éªŒ | @sinclair/typebox + Zod |
| æµ‹è¯• | Vitest |
| æ ¼å¼åŒ–/Lint | Oxfmt + Oxlint |
| æµè§ˆå™¨æ§åˆ¶ | Playwright Core |
| åª’ä½“å¤„ç† | sharp (å›¾ç‰‡) |
| æ•°æ®åº“ | SQLite (sqlite-vec å‘é‡æ‰©å±•) |
| macOS/iOS | SwiftUI |
| Android | Kotlin |

---

## ä¸ƒã€ä¸ºä½ çš„ç®€æ˜“ç‰ˆæœ¬æä¾›çš„è®¾è®¡å»ºè®®

åŸºäºå¯¹ OpenClaw çš„åˆ†æï¼Œå¦‚æœä½ è¦åšä¸€ä¸ª**ç®€æ˜“ç‰ˆæœ¬çš„ AI åŠ©ç†**ï¼Œä»¥ä¸‹æ˜¯æ ¸å¿ƒæ¨¡å—å’Œå¯ç²¾ç®€çš„æ–¹å‘ï¼š

### âœ… å¿…é¡»ä¿ç•™çš„æ ¸å¿ƒ

| æ¨¡å— | åŸå›  |
|------|------|
| **Gateway WS æœåŠ¡å™¨** | å®¢æˆ·ç«¯é€šä¿¡çš„åŸºç¡€ |
| **Agent Runtime** | AI æ¨¡å‹è°ƒç”¨ + Tool use å¾ªç¯ |
| **Session ç®¡ç†** | å¯¹è¯å†å²å’Œä¸Šä¸‹æ–‡ |
| **é…ç½®ç³»ç»Ÿ** | å­˜å‚¨ API Key å’Œè®¾ç½® |
| **è‡³å°‘ 1 ä¸ª Channel** | ç”¨äºæ¥æ”¶/å‘é€æ¶ˆæ¯ï¼ˆå»ºè®® WebChat æˆ– Telegramï¼‰ |

### âŒ å¯ä»¥ç²¾ç®€/å»æ‰çš„

| æ¨¡å— | åŸå›  |
|------|------|
| å¤§é‡ Channel é›†æˆ | ä¿ç•™ 1-2 ä¸ªå³å¯ |
| 38 ä¸ª extensions | é™¤éæœ‰å…·ä½“éœ€æ±‚ |
| macOS/iOS/Android åŸç”Ÿ App | å¯ä»¥åªç”¨ WebChat |
| Voice Wake / Talk Mode | è¯­éŸ³åŠŸèƒ½ |
| Canvas / A2UI | å¯è§†åŒ–ç”»å¸ƒ |
| Tailscale é›†æˆ | æœ¬åœ°ä½¿ç”¨ä¸éœ€è¦ |
| Docker æ²™ç®± | ç®€åŒ–å®‰å…¨æ¨¡å‹ |
| æ¨¡å‹æ•…éšœè½¬ç§» | ç®€æ˜“ç‰ˆç”¨å•ä¸€æ¨¡å‹å³å¯ |
| å¤æ‚çš„ Skill ç³»ç»Ÿ | ç®€åŒ–ä¸ºç›´æ¥çš„ Prompt æ³¨å…¥ |
| æ’ä»¶ç³»ç»Ÿ | å¦‚æœåŠŸèƒ½å›ºå®šåˆ™ä¸éœ€è¦ |
| å¤š Agent è·¯ç”± | ç®€æ˜“ç‰ˆå• Agent è¶³å¤Ÿ |
| Sub-agent ç³»ç»Ÿ | é«˜çº§åŠŸèƒ½ |
| Cron ç³»ç»Ÿ | é™¤ééœ€è¦å®šæ—¶ä»»åŠ¡ |
| è®°å¿†ç³»ç»Ÿ | å¯ä»¥åç»­å¢åŠ  |
| æµè§ˆå™¨æ§åˆ¶ | å¯ä»¥åç»­å¢åŠ  |

### ğŸ¯ æœ€å°å¯è¡Œæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ç®€æ˜“ Gateway          â”‚
â”‚     (Express + WS æœåŠ¡å™¨)    â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Config Loader       â”‚   â”‚  â† åŠ è½½ JSON é…ç½® + API Key
â”‚  â”‚  Session Store       â”‚   â”‚  â† JSONL æ–‡ä»¶å­˜å‚¨å¯¹è¯å†å²
â”‚  â”‚  Agent Runner        â”‚   â”‚  â† è°ƒç”¨ AI API + å·¥å…·å¾ªç¯
â”‚  â”‚  Tool System         â”‚   â”‚  â† bash / read / write
â”‚  â”‚  WebChat Channel     â”‚   â”‚  â† Web UI æ¶ˆæ¯æ”¶å‘
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚  [å¯é€‰] Telegram Channel    â”‚
â”‚  [å¯é€‰] å…¶ä»– Channel        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ ä»£ç é‡ä¼°ç®—

| æ¨¡å— | OpenClaw ä»£ç é‡ | ç®€æ˜“ç‰ˆä¼°ç®— |
|------|----------------|-----------|
| Gateway æœåŠ¡å™¨ | ~800 è¡Œ | ~200 è¡Œ |
| Agent Runtime | ~2000 è¡Œ | ~500 è¡Œ |
| Session ç®¡ç† | ~500 è¡Œ | ~150 è¡Œ |
| å·¥å…·ç³»ç»Ÿ | ~3000 è¡Œ | ~300 è¡Œï¼ˆbash + read + writeï¼‰ |
| é…ç½® | ~2000 è¡Œ | ~100 è¡Œ |
| WebChat Channel | ~500 è¡Œ | ~200 è¡Œ |
| CLI | ~1000 è¡Œ | ~100 è¡Œ |
| **æ€»è®¡** | **~50000+ è¡Œ** | **~1500-2000 è¡Œ** |

---

## å…«ã€å…³é”®ä¾èµ–åº“å‚è€ƒ

å¦‚æœä½ è¦å¤ç”¨éƒ¨åˆ†èƒ½åŠ›ï¼Œä»¥ä¸‹åº“å€¼å¾—å…³æ³¨ï¼š

| åº“ | ç”¨é€” | æ˜¯å¦æ¨èç®€æ˜“ç‰ˆä½¿ç”¨ |
|---|------|---------|
| `@mariozechner/pi-agent-core` | AI Agent æ ¸å¿ƒè¿è¡Œåº“ | âš ï¸ å¯é€‰ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ API |
| `express` | HTTP æœåŠ¡å™¨ | âœ… |
| `ws` | WebSocket | âœ… |
| `commander` | CLI | âœ… å¯é€‰ |
| `json5` | JSON5 é…ç½®è§£æ | âœ… |
| `grammy` | Telegram Bot | âœ… å¦‚éœ€ Telegram |
| `sharp` | å›¾ç‰‡å¤„ç† | âš ï¸ å¯é€‰ |
| `playwright-core` | æµè§ˆå™¨æ§åˆ¶ | âš ï¸ å¯é€‰ |

---

## æ€»ç»“

OpenClaw æ˜¯ä¸€ä¸ª**åŠŸèƒ½æå…¶å®Œå–„ä½†ä½“é‡åºå¤§**çš„ä¸ªäºº AI åŠ©ç†å¹³å°ã€‚å®ƒçš„æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯æ­£ç¡®çš„ï¼š
1. **Gateway ä½œä¸ºä¸­å¿ƒåŒ–æ§åˆ¶é¢æ¿**
2. **Channel æŠ½è±¡å±‚è§£è€¦æ¶ˆæ¯æ¸ é“**
3. **Session éš”ç¦»ä¿è¯å¯¹è¯ç‹¬ç«‹æ€§**
4. **Agent Loop å®ç° AI + å·¥å…·çš„å¾ªç¯è°ƒç”¨**

ä½†å¯¹äºç®€æ˜“ç‰ˆæœ¬ï¼Œä½ åªéœ€è¦æŠ½å–ä¸Šè¿° 4 ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå»æ‰å¤§é‡çš„æ¸ é“é›†æˆã€å¹³å°é€‚é…ã€å®‰å…¨é˜²æŠ¤å’Œè¿ç»´åŠŸèƒ½ï¼Œå³å¯å¾—åˆ°ä¸€ä¸ª**è½»é‡ä½†æ ¸å¿ƒèƒ½åŠ›å®Œæ•´**çš„ AI åŠ©ç†ã€‚
